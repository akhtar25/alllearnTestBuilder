{%extends "layout.html"%} {%block content%}
<div class="container">
                <div class="hold-transition skin-blue sidebar-mini">    
                                <div id="sidebarDiv" >   
                                    <div class="main-sidebar" style="margin-top:15px;">
                                        <section class="sidebar">                     
                                              <ul class="sidebar-menu table-responsive" data-widget="tree">
                                                  {% for singleClass in distinctClasses %}
                                                         <li class="treeview">
                                                           <a href="#">
                                                             <i class="glyphicon glyphicon-education"></i>
                                                             <span>Class {{singleClass[0]}}</span>
                                                             <span class="pull-right-container">
                                                               <span class="label label-primary pull-right">{{singleClass[1]}}</span>
                                                             </span>
                                                           </a>                                                      
                                                           <ul class="treeview-menu">                            
                                                              {% for classsection in classsections %}
                                                                 {% if classsection.class_val==singleClass[0] %}
                                                             <li>
                                                                <a href="{{ url_for('resultUpload',class_val=classsection.class_val, section=classsection.section) }}"> 
                                                                <i class="fa fa-circle-o"></i> Section {{classsection.section}}</a></li>                              
                                                              {% endif %}
                                                             {% endfor %}
                                                           </ul>                                                      
                                                         </li>
                                                         {% endfor %}                
                                         <ul>                  
                                        </section>
                                        <!-- /.sidebar -->
                                    </div>
                                </div>
        <!-------------------------------------------------------------------------------------------  -->
        <div class="content-wrapper" style="background-color: white;">
        <section class="content">
        
        

        <!-- Start Result Table -->

        {% if student_list %}

        <div class="box">
        <div class="box-header">
        <h3 class="box-title">Result Upload</h3><span style="padding-left: 10px;">    Class: {{qclass_val}} | Section: {{qsection}}</span>                              
        </div>
        <div class="right"><a href="{{url_for('resultUploadHistory')}}">Upload History</a></div><br/>
        <p class="right" style="margin-bottom: 0px;">* Please enter -1 for absent students</p>
        <div class="card id" id="result_table" style="margin-top: 24px;">
        <div class="card-body">
          <div id="table" class="table-editable">
            <table class="table table-bordered table-responsive-md table-striped text-center">
                    <thead>
                            <tr>
                                <th scope="col">Student Name</th>
                                
                                {% for subject in subject_name %}
                                <th scope="col">
                                                <p style="margin-bottom: 0px;">
                                                        <label>
                                                        <input type="checkbox" id="marksCheckBox{{loop.index}}" name="selectSubject" value="{{ subject[1]}}"/>
                                                        <span>{{ subject[0]}}</span><br/>
                                                         <input type="text" id="subjectId" value="{{ subject[1]}}" style="display:none;"> 
                                                        
                                                        <div class="marksbox">
                                                        <p class="right" style="margin-bottom: 0px;width: 112px;font-size: 13px;display: flex;margin-right: 6px;"><span style="width: 70px;">Total Marks:</span><input id="Tmarks{{loop.index}}" type="number" max="100" min="-1" name="marks" disabled></p><br/> 
                                                       
                                                       
                                                         <input type="date" name='testdate' id='testdate{{loop.index}}' style="font-size: 13px;width: 127px;margin-bottom: 0px;" disabled> 
                                                         </div>
                                                        </label>
                                                </p>   
                                </th>
                                {% endfor %} 
                             </tr>
                    </thead>
                    <tbody>
                                
                            {% for student in student_list %}
                                <tr>
                                    <td> {{student.full_name }} </td>
                                    {% for subject in subject_name %}
                                    <td><div class="container" style="width:100px;"><input type="number" id="marks{{loop.index}}" name="marks{{loop.index}}" max="100" min="-1" disabled></div></td> 
                                     {% endfor %}
                                </tr>
                            {% endfor %}
                    </tbody>
            </table>
        </div>
        </div>
        </div>
      </div> 
      <p style="padding-left:575px;"><input type="button" class="btn waves-light green lighten-1 white-text" id="upload" name="upload" value="upload"></p>
      </form>
      {% endif %}
        <!-- End Result Upload Table -->
</section>
</div>
</div>  
</div> 
      <link rel="stylesheet" href="../static/css/skins/_all-skins.min.css">
      <script>
        var today = new Date();
        var dd = today.getDate();
        var mm = today.getMonth()+1; //January is 0!
        var yyyy = today.getFullYear();
        if(dd<10){
                dd='0'+dd
        } 
        if(mm<10){
                mm='0'+mm
        } 

        

        today = yyyy+'-'+mm+'-'+dd;
        document.getElementById("testdate").setAttribute("max", today);


        $(document).ready(function(){
        
        var id = '';
        var inputId = '';
         {% for subject in subject_name %}
        $('#marksCheckBox{{loop.index}}').click(function(){
                console.log('Subject Id:'+document.getElementById('marksCheckBox{{loop.index}}').value);
                console.log('Inside checkbox');
            if($(this).prop("checked") == true){
                console.log("Checkbox is checked.");
                
                $('#Tmarks{{loop.index}}').removeAttr("disabled");
                $('#testdate{{loop.index}}').removeAttr("disabled");
                $('[name="marks{{loop.index}}"]').removeAttr("disabled");
            }
            else if($(this).prop("checked") == false){
                console.log("Checkbox is unchecked.");
                $('#Tmarks{{loop.index}}').attr("disabled",true);
                $('#testdate{{loop.index}}').attr("disabled",true);
                $('[name="marks{{loop.index}}"]').attr("disabled",true);
            }
        });
        {% endfor %}
        });

        // $('#upload').click(function(){
        //         {% for subject in subject_name %}
        //                 if(document.getElementById('marksCheckBox{{loop.index}}').value==subject[1]){
        //                         var maxMarks = document.getElementById('Tmarks{{loop.index}}');
        //                         var testDate = document.getElementById('testdate{{loop.index}}');
        //                         var marksArray = new Array();
        //                         $("input[name=marks{{loop.index}}]").each(function(){
        //                                 marksArray.push($(this).val());
        //                         });
        //                 }
        //         {% endfor %}
        // });

        
        
        
    </script>
{%endblock%}