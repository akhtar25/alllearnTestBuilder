{%extends "layout.html"%} {%block content%}

<div class="container">
  <div class="row">
    <h3>Schedule Details</h3>
    <h5>
        <form action="" method="POST" enctype="multipart/form-data">
        <form id="timeTableForm">
            <div class="form-group " style="padding-top:5px;">
            <div class="row">
            <div class="slots" style="display: flex;">
            <div>
                <label>No Of Slots:</label>
                <input type="text" id="slots" name="slots" style="width:50px;"/></br>
            </div>
            <div style="margin-left:50px;width:120px;">
                <label>Class:</label>
                <input type="text" name="class_value" id="class_value" style="width:50px;"/></br>
            </div>
          <div style="width:165px;">
            <label>No of Sections:</label>
            <input type="text" id="batches" name="batches" style="width:50px;"/></br>
        </div>
        <div style="width:230px;">
            <label>No of Days (per week)</label>
            <input type="text" id="nDays" name="nDays" style="width:50px;"/></br>
        </div>
        <!-- <div>
          <label>No of Teachers</label>
          <input type="text" id="noTeachers" name="noTeachers" style="width:50px;"/></br>
        </div> -->
        
      </div>
          </div>
          <div style="display: flex;">
            <div class="Time" style="width: 177px;">
            </div>
            <div class="teachers" id="options" style="width: 177px;">
            </div>
            <div style="width:158px;">
            </div>
            <div class="noOfDays" style="margin-left: -64px;">
                
                <p>
                    <label>
                      <input type="checkbox" name="day" value="Monday" />
                      <span>Monday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Tuesday" />
                      <span>Tuesday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Wednesday" />
                      <span>Wednesday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Thursday" />
                      <span>Thursday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Friday" />
                      <span>Friday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Saturday" />
                      <span>Saturday</span>
                    </label>
                  </p>
            </div>
            <div class="subjectDetails" style="margin-left: 120px;">
              <ul id="addSubTime">
              
            </ul>
          </div>
            
          
            <div class="button" style="text-align: right;margin-top: 240px;">
                <button class="btn waves-light green lighten-1 white-text" id="submit" value="submit">Confirm</button>
            </div>
        </div>
        </div>
      </form>
</form>
   
  {% endfor %}
  </div>
  <div class="row">

    <div class="input-field col s12">
      <select>
        <option value="" disabled selected>Choose class</option>
        <option value="1">Option 1</option>
        
      </select>
      <label>Materialize Select</label>
    </div>
  </div>
</div>

<script>

  $('#addSubTime').click(function(){

  });

  $("#slots").blur(function(){
  var slots = $('#slots').val();
  var input = '';
  for(var i=0;i<slots;i++){
    input = input + '<label>Start:</label><input type="text" name="start" id="start1" style="width:50px;"/><label>End:</label><input type="text" name="end" id="end1" style="width:50px;"/></br>'
  }
  $('.Time').html(input);
});

$('#class_value').blur(function(){
    console.log('inside class_val blur');
    var class_v = $('#class_value').val();
    $.ajax({
            url: "/allSubjects?class_value=" + class_v,
            type: "get",
            data: "",
            success: function (response) {
              subTimeHtml = '';  
              console.log(response);  
              responseArr = response.toString().split(',');
              for(var i=0;i<responseArr.length;i++){
                console.log(responseArr[i]);
                subTimeHtml = subTimeHtml+ '<li><label>'+responseArr[i]+'</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<input type="hidden" id="subject1" value="'+responseArr[i]+'" name="subject" style="width:50px;" /><label>Time(hours)**</label><input type="text" id="time1" name="time" style="width:50px;"/></li>';
              }
              $('#addSubTime').html(subTimeHtml);
            },
            error: function (xhr) {
                window.alert("error occurred while fetching subjects list");
            }
        });
  });


$(document).ready(function(){
    $('select').formSelect();
  });

  $('#submit').click(function(){
    $e.preventDefault(); 
    var form = $('#timeTableForm');  
    $.ajax({
            url: "/schedule",
            type: "POST",
            data: form.serialize(),
            success: function (formResponse) { 
              
           
            },
            error: function (xhr) {
              $('#errorMSGSpan').html('Error in creating timetable Please try again.');  
            }
        });
  });


</script>

{% endblock %}