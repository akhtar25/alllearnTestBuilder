{%extends "layout.html"%} {%block content%}

<div class="container">
    <h3>Schedule Details</h3>
    <h5>
        <form action="" method="POST" enctype="multipart/form-data">
        <div class="timeTableForm">
            {{ form.hidden_tag() }}
            <div class="form-group " style="padding-top:5px;">
            <div class="row">
            <div class="slots" style="display: flex;">
            <div>
                <label>No Of Slots:</label>
                <input type="text" id="slots" name="slots" style="width:50px;"/></br>
            </div>
            <div style="margin-left:50px;width:177px;">
                <label>Class:</label>
                <input type="text" id="class_value" name="class_value" style="width:50px;"/></br>
            </div>
          <div style="width:177px;">
            <label>No of Sections:</label>
            <input type="text" id="batches" name="batches" style="width:50px;"/></br>
        </div>
        <div style="width:230px;">
            <label>No of Days (per week)</label>
            <input type="text" id="nDays" name="nDays" style="width:50px;"/></br>
        </div>
        <!-- <div>
          <label>No of Teachers</label>
          <input type="text" id="noTeachers" name="noTeachers" style="width:50px;"/></br>
        </div> -->
        <div class="subjectDetails">
          <label>Subject</label>
          <input type="text" id="subject1" name="subject" style="width:50px;"/>
          <label>Time(hours)**</label>
          <input type="text" id="time1" name="time" style="width:50px;"/></br>
          <i class="fa fa-plus" aria-hidden="true"></i>
      </div>
          </div>
          <div style="display: flex;">
            <div class="Time" style="width: 177px;">
            </div>
            <div class="teachers" id="options" style="width: 177px;">
            </div>
            <div style="width:177px;">
            </div>
            <div class="noOfDays">
                
                <p>
                    <label>
                      <input type="checkbox" name="day" value="Monday" />
                      <span>Monday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Tuesday" />
                      <span>Tuesday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Wednesday" />
                      <span>Wednesday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Thursday" />
                      <span>Thursday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Friday" />
                      <span>Friday</span>
                    </label>
                  </p>
                  <p>
                    <label>
                      <input type="checkbox" name="day" value="Saturday" />
                      <span>Saturday</span>
                    </label>
                  </p>
            </div>
            <!-- <div class="teacherDetails">
                
                <label>Name</label>
                <input type="text" id="nameTeacher1" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject1" name="nameSubject" style="width:50px;"/></br>
                <label>Name</label>
                <input type="text" id="nameTeacher2" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject2" name="nameSubject" style="width:50px;"/></br>
                <label>Name</label>
                <input type="text" id="nameTeacher3" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject3" name="nameSubject" style="width:50px;"/></br>
                <label>Name</label>
                <input type="text" id="nameTeacher4" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject4" name="nameSubject" style="width:50px;"/></br>
                <label>Name</label>
                <input type="text" id="nameTeacher5" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject5" name="nameSubject" style="width:50px;"/></br>
                <label>Name</label>
                <input type="text" id="nameTeacher6" name="nameTeacher" style="width:50px;"/>
                <label>Subject</label>
                <input type="text" id="nameSubject6" name="nameSubject" style="width:50px;"/></br>
            </div> -->
            
          </div>
            
          
            <div class="button" style="text-align: center;">
                <button class="btn waves-light green lighten-1 white-text" type="submit" value="submit">Confirm</button>
            </div>
        </div>
        </div>
    </div>
</form>
    </h5>
    {% for  slot in slotsoutput %}
    <h1>Class: 12th ({{loop.index}})</h1>
    <table class="table table-hover">
      <thead>
    <tr>
      <th></th>
      {% for time in slotTime %}  
      <th>{{time}}</th>                        
      {% endfor %}                      
    </tr>
  </thead>
    <div >
        <tbody>
    
    <tr class="list">
      <td></td>
      {% for data in scheduleData %}
      <td>
        {{data.subject}}</br>
        {{data.teacher}}
      </td>
      {% endfor %}
    </tr>           
  </tbody>
  </div>
  </table>
  {% endfor %}
</div>

<script>

  $('#class_value').blur(function(){
    var class_v = $('#class_value').val();
    $('#options').show();
    $.ajax({
            url: "/allTeachers?class_value=" + class_v,
            type: "get",
            data: "",
            success: function (response) {                
              responseArr = response.toString().split(',');
              console.log(responseArr);
              var optionHtml = '';
              console.log(responseArr.length)
              if(responseArr.length>2){
              for(var i=0;i<responseArr.length;i++){
                var teacher_name = responseArr[i].toString().split(':')[0];
                var subject_name = responseArr[i].toString().split(':')[1];
                var teacher_id = responseArr[i].toString().split(':')[2];
                console.log(teacher_name+' '+subject_name+' '+teacher_id);
                optionHtml = optionHtml + '<p><label><input type="checkbox" name="teacher" value='+teacher_id+' /><span>'+teacher_name+' - '+subject_name+'</span></label></p>'
              }
              }
              if(optionHtml){
              $('.teachers').html(optionHtml);
              }else{
                optionHtml = '<p>No data available</p>'
              }
              $('.teachers').html(optionHtml);
            },
            error: function (xhr) {
                window.alert("error occurred while fetching teachers list");
            }
        });
  });

  $("#slots").blur(function(){
  var slots = $('#slots').val();
  var input = '';
  for(var i=0;i<slots;i++){
    input = input + '<label>Start:</label><input type="text" name="start" id="start1" style="width:50px;"/><label>End:</label><input type="text" name="end" id="end1" style="width:50px;"/></br>'
  }
  $('.Time').html(input);
});

$(document).ready(function(){
    $('select').formSelect();
  });
</script>

{% endblock %}