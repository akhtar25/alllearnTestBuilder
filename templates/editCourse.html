{%extends "layout.html"%} {%block content%}
<style>
    #myInput {

        background-position: 10px 12px;
        background-repeat: no-repeat;
    }

    .select-wrapper{
        width:50%;
    }

    #myUL li a {
        border: 1px solid #ddd;
        margin-top: -1px;
        /* Prevent double borders */
        background-color: #f6f6f6;
        padding: 5px;
        text-decoration: none;
        font-size: 14px;
        color: black;
        display: block
    }

    #myUL li a:hover:not(.header) {
        background-color: #eee;
    }
</style>
<link href="../static/css/jquery.magicsearch.css" rel="stylesheet">
<div class="container">
    <div class="row">
        <div class="col-sm-8">
            <h2 class="">Add/Edit Course</h2>
            <!--<p class="grey-text text-darken-3 lighten-3" style="font-size: 16px;">
        </p>-->
        <form id="courseForm">
            <h4 style="margin-top: 15px;">Course Name</h4>
            {% if course_id %}
            <input type="text" name="course" value="{{courseDet.course_name}}" id="course" onblur="courseAdd();"/>
            <input type="hidden" value="{{courseDet.course_id}}" name="courseId" id="courseId" />
            {% else %}
            <input type="text" name="course" value="" id="course" onblur="courseAdd();"/>
            <input type="hidden" value="" name="courseId" id="courseId" />
            {% endif %}
            <h4>Description</h4>
            <textarea id="description" value="" name="description" style="height: 6em;"></textarea>
            <!-- <div>
                <h3 class="">Next Batch</h3>
                <div class="col-sm-4">
                    Set Date: <input type="text" name="setDate" class="datepicker">
                </div>
                <div class="col-sm-4" >
                    Start Time: <input type="text" name="startTime" class="timepicker" >
                </div> 
                <div class="col-sm-4">
                    End Time: <input type="text" name="endTime" class="timepicker">
                </div>
            </div>
            <div>
                Days of week<br>
                <p style="font-family: Arial;">
                    <label>
                        <input type="checkbox" value="Mo" name="Days" />
                        <span>Mo</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="Tu" name="Days" />
                        <span>Tu</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="We" name="Days" />
                        <span>We</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="Th" name="Days" />
                        <span>Th</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="Fr" name="Days" />
                        <span>Fr</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="Sa" name="Days" />
                        <span>Sa</span>
                    </label> &nbsp;&nbsp;&nbsp;&nbsp;

                    <label>
                        <input type="checkbox" value="Su" name="Days" />
                        <span>Su</span>
                    </label>&nbsp;&nbsp;&nbsp;&nbsp;
                </p>
            </div> -->
            <!--<button class="btn green right" style="width: 100%;">Enroll</button>-->
            <h3 class="">Upload Course Picture</h3>
            <p>
                <!--<video src="../static/images/vid1.m4v" width="100%" controls></video>-->
                <input type="file" id="courseImg" onchange="initUpload('3');" name="courseImg" style="height: 30px; margin-top: 10px;">
                {% if course_id %}
                <input type="hidden" id="imageUrl" value="{{courseDet.image_url}}" name="imageUrl">
                {% else %}
                <input type="hidden" id="imageUrl" value="" name="imageUrl">
                {% endif %}
                <br>
                <div class="center">
                    <span id="image_name">Sample Image</span><br>
                    {% if course_id %}
                    {% if courseDet.image_url %}
                    <img src="{{courseDet.image_url}}" id="previewImg" class="" width="50%" />
                    {% else %}
                    <img src="../static/images/chris-barbalis-oOBMoCOgGrY-unsplash.jpg" id="previewImg" class="" width="50%" />
                    {% endif %}
                    {% else %}
                    <img src="../static/images/chris-barbalis-oOBMoCOgGrY-unsplash.jpg" id="previewImg" class="" width="50%" />
                    {% endif %}
                </div>
            </p>
            <br><br>

            <h3 class="">What to expect</h3>
            <p>Upload a short 2 min video of what the students should expect
                <!--<video src="../static/images/vid1.m4v" width="100%" controls></video>-->
                <input type="file" id="video_url" onchange="initUpload('1');" name="video_url" style="height: 30px; margin-top: 10px;">
                {% if course_id %}
                <input type="hidden" id="videoUrl" value="{{courseDet.summary_url}}" name="videoUrl">
                {% else %}
                <input type="hidden" id="videoUrl" value="" name="videoUrl">
                {% endif %}
                <br>
                <div class="center">
                    <span id="video_name">Sample Video</span><br>
                    {% if course_id %}
                    {% if courseDet.summary_url %}
                    <video src="{{courseDet.summary_url}}" id="preview" class="" width="50%" controls></video>
                    {% else %}
                    <video src="../static/images/vid1.m4v" id="preview" class="" width="50%" controls></video>
                    {% endif %}
                    {% else %}
                    <video src="../static/images/vid1.m4v" id="preview" class="" width="50%" controls></video>
                    {% endif %}
                </div>
            </p>
            <br>

            <!--Section to add topics-->
            <h3 class="">Topics</h3>
            <div>
                <input type="text" id="myInput" onkeyup="myFunction()" placeholder="Search for topics.."
                    title="Type in a topic" style="width:90%;"><i class="material-icons black-text right"
                    style="font-size: medium;cursor: pointer;" id="searchIcon">search</i>
            </div>
            <div class="" style="overflow-y: auto;height: 150px;">
                <ul id="myUL">
                    <!-- <li><a class="modal-trigger" href="#topicAddModal">Topic15</a></li> -->

                </ul>
            </div>
            <div id="newTopicBtnDiv" class="right">
                Can't find topic? <a class="modal-trigger" onclick="addNew();" href="#topicAddModal" id="topicModal"><i class="material-icons black-text"
                        style="font-size: medium;">add_box</i> Add new</a>
            </div>
            <span style="display: flex;"><h4>Added Topics</h4><a onclick="topicList();" style="margin-left: 20px;margin-top: 10px;cursor: pointer;"><i class="fa fa-refresh" aria-hidden="true"></i></a></span>
            <table class="highlight">
                <thead>
                    <tr>
                        <th>Topic</th>
                        <th>Quiz Questions</th>
                        <th>Add Notes</th>
                        <th>Add Class Recording</th>                        
                        <th>Delete</th>
                    </tr>
                </thead>
                <tbody style="font-size:medium" id="topicListDiv">
                    {% if course_id %}
                    {% if topicDet %}
                    {% for topic in topicDet %}
                    <tr>
                        <td>
                            <a class="modal-trigger" onclick="editTopic('{{topic.topic_id}}');editQues();" href="#topicAddModal">
                                {{topic.topic_name}}
                            </a>
                        </td>
                        <td>
                            {{topic.no_of_questions}}
                        </td>
                        <td>
                            <a class="modal-trigger" onclick="topicId('{{topic.topic_id}}');" href="#topicNotesModal">Add Notes</a>
                        </td>
                                                <td>
                            <a class="modal-trigger" onclick="topicRecordingId('{{topic.topic_id}}');" href="#recordClassModal">Add Class Recording</a>
                        </td>
                        <td>
                            <a title="Delete Need" name="" href="javascript:void(0);" class=" btn-floating btn-small orange deleteBTNClass">
                                <i class="material-icons small" onclick="deleteTopic('{{topic.topic_id}}');" style="cursor:pointer;">
                                    delete
                                </i>
                            </a>
                        </td>
                    </tr>
                    {% endfor %}
                    {% else %}
                    <tr>
                        <td colspan="4" style="text-align: center;">
                            No Topic Available
                        </td>
                    </tr>
                    {% endif %}
                    {% endif %}
                </tbody>
            </table>
            <br>


            <!--<img src="../static/images/reviewIMG.PNG" width="50%">-->

            <h3 class="">Ideal for</h3>
            {% if course_id %}
            {% if idealFor %}
            <!-- <input class="magicsearch" name="idealfor" id="topicSearch" value="{{idealFor}}" placeholder="{{idealFor}}"> -->
            <input type="text" name="idealfor" value="{{idealFor}}" disabled/>
            {% else %}
            <input class="magicsearch" name="idealfor" id="topicSearch" placeholder="Search categories...">
            <input type="text" name="idealfor" value="" disabled/>
            {% endif %}
            {% else %}
            <input class="magicsearch" name="idealfor" id="topicSearch" placeholder="Search categories...">
            {% endif %}
            <!--
            <p>Press Enter after each group name<div class="chips"></div>
            </p>-->
            <br><br>
            <h3>Difficulty Level</h3>
            <p>
                <div class="input-field">
                    <select id="level_val" name="level">
                        <option value="Easy" selected>Easy</option>
                        <option value="Medium">Medium</option>
                        <option value="Hard">Hard</option>
                        <!--<option value="11">11</option>
                    <option value="12">12</option>-->
                    </select>
                </div>
            </p>
            <p style="margin-top:20px;">
                <label>
                    {% if course_id %}
                        {% if courseDet.is_private=='Y' %}
                        <input type="checkbox" id="private" name="private" value="Y" checked/>
                        {% else %}
                        <input type="checkbox" id="private" name="private" value="Y" />
                        {% endif %}
                    {% else %}
                  <input type="checkbox" id="private" name="private" value="Y" />
                  {% endif %}
                  <span>Do you want to make your course private?</span>
                </label>
              </p>
              
            <a href="#" class="btn green" id="save">Save</a>
            <a href="#" class="btn green right" id="saveAndPublish">Save and Publish Course</a>
 
        </form>
        <span id="msg" style="margin-top: 20px;color: red;"></span>
        </div>
        <div class="col-sm-4">

            <div class=""
                style="background-color: rgb(248, 248, 231);border-radius: 25px;border: 2px solid rgb(226, 223, 223);padding: 10px; ">
                <ul style="margin-left: 20px;margin-top:10px;font-size:medium">
                    <h3>Things to keep in mind</h3>
                    <li style="list-style-type: initial;">
                        Keep the content light and interactive
                    </li>
                    <li style="list-style-type: initial;">
                        It's okay if you don't know how or where to start. Let this be a starting point.
                    </li>
                    <li style="list-style-type: initial;">Don't try to cover everything in one course. If there's a lot
                        you want to share, split in multiple courses</li>
                    <li style="list-style-type: initial;">Do not keep a single class more than 1 hour at a stretch. Even
                        if you want, keep a 10-20 min break in between</li>
                    <li style="list-style-type: initial;">Try to site as many examples as possible. This helps the
                        students connect content with practice.</li>
                    <li style="list-style-type: initial;">Ensure that you add a couple of questions with each topic.
                        This helps the students solidify their understanding of what's been taught</li>
                    <li style="list-style-type: initial;">The 'What to expect' video should be a summary of all that
                        will be covered during the course.</li>
                    <li style="list-style-type: initial;">Always be punctual</li>
                    <br>
                    <h4>FAQs</h4>
                    <li style="list-style-type: initial;">
                        <b>What if my class is not up to the mark?</b>
                        <br> There are two ways the users can express themselves: Reviews and Donations.<br>
                        Take their help to gather feedback for improvement. JUST GET STARTED.
                    </li>
                    <li style="list-style-type: initial;"><b>I don't know what to teach</b>
                        <br>All of us have something we can teach to others.<br>
                        Sometimes your learnings could be just about what not to do.
                    </li>
                    <li style="list-style-type: initial;">
                        <b>What if a topic can't be covered in a single 1 hour class</b><br>
                        If a topic can't be covered in a single class, split it in multiple classes. eg Data Structures
                        - part 1 <i>and </i>Data Structures - part 2</li>
                    <li style="list-style-type: initial;">
                        <b>How will I receive the donations?</b><br>
                        We'll be transferring them within 2 days of us receiving the donations to your bank account.
                    </li>
                    <li style="list-style-type: initial;">
                        <b>Can I raise funds for someone else?</b><br>
                        Definitely, in fact we encourage that. If you're raising funds for someone through your classes,
                        the money will be transferred directly to their account.
                        <br> 
                    </li>
                </ul>
            </div>
        </div>
    </div>
</div>

<!--Modal section-->
<div class="modal" id="topicAddModal">
    <div class="modal-content" style="height: 100%;">
    <!-- <div class="col lg s6" id="unselect">
            <ul class="tabs">
                <li class="tab col s3">
                    <a href="javascript:void(0);" id="topic" class="tabFont">Review and Add Topic</a>
                </li>
                <li class="tab col s3">
                    <a href="javascript:void(0);" id="notes" class="tabFont">Review and Add Notes</a>
                </li>
            </ul>
    </div> -->
    <div id="section1" style="margin-top:10px;height: 90%;position: relative;">
        <div>
            <!-- <h4>Review and Add Topic</h4> -->
            <input type="text" value="" style="font-size: xx-large;" id="topicName" placeholder="Topic Name">
            <input type="hidden" value="" id="topicId" />
            <!-- <label for="topicDesc">Description (optional)</label> -->
            <!-- <input type="text" placeholder="Description" id="topicDesc" style="width: 70%;"> -->
            <!--<textarea id="topicDesc" style="height: 50px;"></textarea>-->
            <br>
            <span style="font-size: large;">Questions</span>
            <a class="newQuestion" href="#">Add New Question</a>
            <a class="forEdit" style="display:none;" href="#">Add New Question</a>
            <div id="questionDiv" style="height: 220px;overflow-y: auto;border-radius: 10px;border: 2px solid rgb(226, 223, 223);padding: 10px; ">
                <div>
                    <table id="quesForm">
                        
                    </table>
                    <table id="questionList">

                    </table>
                </div>
            </div>
            <div>
                <button class="btn green right" id="saveTopic" style="margin-top: 8px;" disabled> Save Topic</button>

                <button class="btn green right" id="updateTopic" style="margin-top: 8px;display: none;">Confirm</button>
            </div>
        </div>        
    </div>
    </div>
</div>

<div class="modal" id="recordClassModal" style="width: 450px;height: 230px;">
    <div class="modal-content" style="max-height: 400px;position: relative;overflow-y: auto;">
        <h3>Class Recording</h3>
        <form id="recordClassForm">
            
                <!--<video src="../static/images/vid1.m4v" width="100%" controls></video>-->
                Class Recording URL:
                <input type="text" id="recordingURL" name="recordingURL" style="width:200px;margin-left: 10px;" placeholder="eg. Youtube video or pdf">
                <br><h4>OR</h4><br>
                <input type="file" id="video_record_url" onchange="initUpload('10');" name="videoRecordUrl" style="height: 30px; margin-top: -10px;">
                <input type="hidden" id="videoRecordUrl" value="" name="videoRecordUrl">
                <!-- <ol><div id="topicNotDiv" style="max-width: 80%;"></div></ol>
                <a href="#" id="addNotesBTN">
                    <i class="material-icons" class="green center">add_circle</i> 
                    <span style="font-size: large;">Add More</span></a> -->
                    <span id="msgRec" style="color: red;"></span>
        <button class="btn green" id="videoRecord" style="margin-left: 270px;">upload Record</button>
    </form>
    </div>
</div>



<div class="modal" id="topicNotesModal" style="width: 450px;">
    <div class="modal-content" style="height: 400px;position: relative;overflow-y: auto;">
        <form id="topicNotesForm">
            <div id="botBox">
        <input type="text" value="" id="notesName1" style="font-size: 20px;margin-top: 10px;" name="notesName" placeholder="Notes Name">
                <select style="width:50%" class="selType" onchange="fileType(this.value,0)">
                    <option value="">choose file type</option>
                    <option value="1">place url</option>
                    <option value="2">upload file</option>
                </select>
                <div id="url" class="notes0" style="display: none;margin-top: 16px;">
                Notes URL:
                <input type="text" id="notesURL1" name="notesURL" style="width:200px;margin-left: 10px;" placeholder="eg. Youtube video or pdf">
                </div>
                <div style="display: flex;margin-top: 16px;">
                <input type="file" id="video_notes_url" class="fnotes0" onchange="initUpload(2);" name="video_url" style="height: 30px;display: none;"> 
                <div id="fileLoader" style="display: none;">
                    <img src="../static/images/loader.gif" style="width: 16%;margin-left: -90px;">
                </div>
                </div>
                <input type="hidden" id="videoNotesUrl1" value="" name="videoNotesUrl"> 
            </div>
                <div id="topicNotDiv" style=""></div>
                <a href="#" id="addNotesBTN">
                    <i class="material-icons" class="green center">add_circle</i> 
                    <span style="font-size: large;">Add More</span></a><br>
        <span id="notesMsg" style="color: red;"></span>
        <button class="btn green" id="saveNotes" style="margin-left: 270px;" >upload Notes</button>
        <button class="btn green" id="updateNotes" style="margin-left: 270px;display: none;">update Notes</button>
    </form>
    </div>
</div>
<!--End of modal section-->


<script>

    $('#topicName').blur(function(){
        if($('#topicName').val()!=''){
        $('#saveTopic').prop('disabled',false);
        }else{
            $('#saveTopic').prop('disabled',true);
        }
    });

    

    $('.notes').click(function(){
        if ($('.notes').length > 0)
         {
             $('.notes').each(function (i, obj) {
                 $(this).find("input[type=text]").each(function () {
                     alert($(this).val());
                 });

             });
         }
    });

    function fileType(x,index){
        var selectValue = x;
        console.log('Value:'+selectValue);
        if(selectValue==1){
            $('.notes'+index).show();
            $('.fnotes'+index).hide();
        }else{
            $('.fnotes'+index).show();
            $('.notes'+index).hide();
        }
    };

    function fetchRecording(topId){
        console.log('inside fetch Recording');
        var courseId = "{{course_id}}";
        $.ajax({
            url: "/fetchRecording?topic_id="+topId+"&courseId="+courseId,
            type: "POST",
            data: "",
            success: function (formResponse) { 
                console.log(formResponse);
                $('#recordingURL').val(formResponse);
            },
            error:function(xhr){
                $('#msg').html('Error in fetching Recording. Please try again.'); 
            }
        });
    }

    $('#video_record_url').change(function(){   
            if($('#video_record_url').val()){
              $('#recordingURL').prop('disabled', true);
            }else{
              $('#recordingURL').prop('disabled', false);
            }
        });

    function fetch(topId){
        // $('#addNotesBTN').hide();
        $('#topicNotDiv').html('');
        $('#botBox').hide();
        console.log('inside fetch'+topId);
        $.ajax({
            url: "/fetchNotes?topic_id="+topId,
            type: "POST",
            data: "",
            success: function (formResponse) { 
             if(formResponse){
                var responseArr = formResponse.toString().split(',');
                var notesDiv = '';
                for(var i=0;i<responseArr.length;i++){
                    var notes_name = responseArr[i].toString().split('!')[0];
                    var notes_url = responseArr[i].toString().split('!')[1];
                    console.log('Notes name:'+notes_name);
                    console.log('Notes url:'+notes_url);
                    // $('#notesName').val(notes_name);
                    
                    notesDiv = notesDiv + '<input type="text" value="'+notes_name+'" id="notesName'+i+'" style="font-size: 20px;margin-top: 10px;" name="notesName" placeholder="Notes Name"><select style="width:50%;display:none;" class="selType" onchange="fileType(this.value,'+i+')"><option value="">choose file type</option><option value="1">place url</option><option value="2">upload file</option></select><div id="url'+i+'" class="notes'+i+'" style="margin-top: 16px;"><span id='+i+'>Notes URL:<span><input type="text" value="'+notes_url+'" id="notesURL'+i+'" name="notesURL" style="width:200px;margin-left: 10px;" placeholder="eg. Youtube video or pdf"></div><div style="display: flex;margin-top: 16px;"><input type="file" class="fnotes'+i+'" id="video_notes_url" onchange="initUpload(2);" name="video_url" style="height: 30px;display: none;"> <div id="fileLoader" style="display: none;"><img src="../static/images/loader.gif" style="width: 16%;margin-left: -90px;"></div></div><input type="hidden" id="videoNotesUrl'+i+'" value="" name="videoNotesUrl">';
                }
                // if(notes_name&&notes_url){
                    // console.log(notesDiv);
                    clicks =i+1;
                $('#topicNotDiv').html(notesDiv);
                $('#saveNotes').hide();
                $('#updateNotes').hide();
                for(var i=0;i<responseArr.length;i++){
                    if($('#notesName'+i.toString()).val()==''){
                        $('#notesName'+i.toString()).hide();
                        console.log($('#notesName'+i.toString()).val());
                    }
                    if($('#notesURL'+i.toString()).val()==''){
                        console.log('#url'+i.toString());
                        $('#notesURL'+i.toString()).hide();
                    }
                }
                // }else{
                //     $('#saveNotes').show();
                // $('#updateNotes').hide();
                // }
             }
            },
            error: function (xhr) {
              $('#msg').html('Error in creating homework. Please try again.');  
            }
        }); 
    }

    var topId = '';
    function topicId(topic_id){
        topId = topic_id;
        fetch(topId);
        return 0;
    }
    function topicRecordingId(topic_id){
        topId = topic_id;
        fetchRecording(topId);
        return 0;
    }

$('#videoRecord').click(function($e){
    $e.preventDefault();
    var form = $('#recordClassForm'); 
    console.log('topic_id:'+topId); 
    var course_id = "{{course_id}}"; 
    var recordingURL = $('#recordingURL').val();
    var videoRecordUrl = $('#videoRecordUrl').val();
    if(recordingURL==''&&videoRecordUrl==''){
    
        $('#msgRec').html('please upload or place url of class recording');
    
    }else{
    $.ajax({
            url: "/addRecording?topic_id="+topId+"&course_id="+course_id,
            type: "POST",
            data: form.serialize(),
            success: function (formResponse) { 
             if(formResponse){
                M.toast({html: 'Record added successfully'});
             }
            },
            error: function (xhr) {
              $('#msg').html('Error in creating homework. Please try again.');  
            }
        }); 
    }
});

$('#updateNotes').click(function($e){
    $e.preventDefault();
    
    var form = $('#topicNotesForm'); 
    console.log('topic_id:'+topId);
    $.ajax({
            url: "/updateNotes?topic_id="+topId,
            type: "POST",
            data: form.serialize(),
            success: function (formResponse) { 
             if(formResponse){
                M.toast({html: 'Notes updated successfully'});
             }
            },
            error: function (xhr) {
              $('#errorMSGSpan').html('Error in creating homework. Please try again.');  
            }
        }); 
});

$('#saveNote').click(function($e){
    // var notesName = $('#notesName').val();
    // var notesUrl = $('#notesURL').val();
    // var videoNotesUrl = $('#videoNotesUrl').val();
    // console.log('notesName:'+notesName);
    // console.log('notesUrl:'+notesUrl);
    // console.log('videoNotesUrl:'+videoNotesUrl);
    // $e.preventDefault();
    // if(notesName==''){
    //     $('#notesMsg').html('please enter notes name');
    // }else
    // if(notesUrl==''&&videoNotesUrl==''){
    //     $('#notesMsg').html('please enter notesUrl or upload file');
    // }else{
    $e.preventDefault(); 
    var form = $('#topicNotesForm'); 
    console.log('topic_id:'+topId);  
    $.ajax({
            url: "/addNotes?topic_id="+topId,
            type: "POST",
            data: form.serialize(),
            success: function (formResponse) { 
             if(formResponse){
                M.toast({html: 'Notes added successfully'});
             }
            },
            error: function (xhr) {
              $('#errorMSGSpan').html('Error in creating homework. Please try again.');  
            }
        });   
    // }    
});

        var clicks = 1;
        $('#addNotesBTN').click(function () {
        clicks=clicks+1;        
        $('#topicNotDiv').append('<input type="text" value="" id="notesName'+clicks+'" style="font-size: 20px;margin-top: 10px;" name="notesName" placeholder="Notes Name"><select style="width:50%" class="selType" onchange="fileType(this.value,'+clicks+')"><option value="">choose file type</option><option value="1">place url</option><option value="2">upload file</option></select><div id="url" class="notes'+clicks+'" style="display: none;margin-top: 16px;">Notes URL:<input type="text" id="notesURL'+clicks+'" name="notesURL" style="width:200px;margin-left: 10px;" placeholder="eg. Youtube video or pdf"></div><div style="display: flex;margin-top: 16px;"><input type="file" class="fnotes'+clicks+'" id="video_notes_url" onchange="initUpload(2);" name="video_url" style="height: 30px;display: none;"> <div id="fileLoader" style="display: none;"><img src="../static/images/loader.gif" style="width: 16%;margin-left: -90px;"></div></div><input type="hidden" id="videoNotesUrl'+clicks+'" value="" name="videoNotesUrl"> ');
        $('select').formSelect();
        });

        $('#saveNotes').click(function($e){
            $e.preventDefault();
            console.log('inside save notes');
            click=0;
            if(clicks>1){
            var click = clicks-1;
            }
            console.log('value of no of block:'+clicks);
            for(var i=1;i<=clicks;i++){
                var noteName = '#notesName'+i;
                // console.log('notesName id:'+noteName);
                noteName = $(noteName).val();
                var url = '#notesURL'+i;
                // console.log('url:'+url);
                url = $(url).val();
                var file = '#videoNotesUrl'+i;
                // console.log('file:'+file);
                file = $(file).val();
                // console.log('Notesname:'+noteName);
                // console.log('url:'+url);
                // console.log('file:'+file);
                console.log('Notes Name:'+noteName);
                console.log('#notesName'+i);
                if(noteName==''||noteName==undefined){
                    console.log(i+'Note name value is null');
                    $('#notesMsg').html('please fill notes name for '+i+' notes');
                    break;
                }else
                if((url==''||url==undefined)&&(file==''||file==undefined)){
                    console.log('upload value in notes '+i);
                    $('#notesMsg').html('please upload notes for '+i+' notes');
                    break;
                }else{
                    console.log('all values are fill');
                    // $e.preventDefault(); 
            if(i==clicks){
                console.log('value of i:'+i);
                console.log('value of clicks:'+clicks);
                    var form = $('#topicNotesForm'); 
                    console.log('topic_id:'+topId);  
                    $.ajax({
            url: "/addNotes?topic_id="+topId,
            type: "POST",
            data: form.serialize(),
            success: function (formResponse) { 
             if(formResponse){
                M.toast({html: 'Notes added successfully'});
             }
            },
            error: function (xhr) {
              $('#errorMSGSpan').html('Error in creating homework. Please try again.');  
            }
        }); 
                }
                    
                }
            }
        });



    $(document).ready(function(){
        {% if course_id %}
        {% if courseDet.description %}
            $('#description').val("{{courseDet.description}}");
        {% endif %}
        {% endif %}
    });

    

    function editQues(){
        $('#saveTopic').hide();
        $('#updateTopic').show();

        $('.newQuestion').hide();
        $('.forEdit').show();
    }
    $(document).ready(function(){
        quesIDList = [1];
    });

    $('#topicModal').click(function(){
        console.log('inside topic modal');
        quesIDList = [];
        $('#quesForm').html('');
        $('#questionList').html('');
        $('#topicName').val('');
        questionDiv = '';
        quesListDiv = '';
    });

    $('.newQuestion').click(function(){
        $('.newQuestion').hide();
    });

    $('.forEdit').click(function(){
        $('.forEdit').hide();
    });

function correctOption(correct){
      document.getElementById('correct').value=correct.value; 
    }
    var questionDiv = '';
    $('.newQuestion').click(function(){
        console.log('add new question');
        questionDiv = questionDiv + '<tr><td><input type="text" id="questionInput" placeholder="Write Question"><ul><li><label><input class="with-gap" id="optionRad1" name="optionChoice" type="radio" value="1" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 1" id="option1" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad2" name="optionChoice" type="radio" value="2" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 2" id="option2" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad3" name="optionChoice" type="radio" value="3" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 3" id="option3" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad4" name="optionChoice" type="radio" value="4" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 4" id="option4" class="option_class" name="option_desc"></span></label></li></ul></td><td><input type="hidden" id="correct" name="correct" value=""><span id="msgQues" style="color:red"></span><button class="btn green" id="addNewQues" style="float:right;" onclick="addQues();">Add Question</button></td></tr>';
        $('#quesForm').html(questionDiv);
    });
    var quesEditDiv = '';
    $('.forEdit').click(function(){
        quesEditDiv = quesEditDiv + '<tr><td><input type="text" id="questionInput" placeholder="Write Question"><ul><li><label><input class="with-gap" id="optionRad1" name="optionChoice" type="radio" value="1" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 1" id="option1" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad2" name="optionChoice" type="radio" value="2" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 2" id="option2" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad3" name="optionChoice" type="radio" value="3" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 3" id="option3" class="option_class" name="option_desc"></span></label></li><li><label><input class="with-gap" id="optionRad4" name="optionChoice" type="radio" value="4" onclick="correctOption(this);"><span><input type="text" style="width:200px;" placeholder="Option 4" id="option4" class="option_class" name="option_desc"></span></label></li></ul></td><td><input type="hidden" id="correct" name="correct" value=""><button class="btn green" style="float:right;" onclick="addEditQues();">Add Question</button></td></tr>';
        $('#quesForm').html(quesEditDiv);
    });

    function addEditQues(){
        console.log('inside addQues');
        var corr = $('#correct').val();
        var ques = $('#questionInput').val();
        var opt1 = $('#option1').val();
        var opt2 = $('#option2').val();
        var opt3 = $('#option3').val();
        var opt4 = $('#option4').val();
        if(ques==''){
            $('#msgQues').html('please enter question');
        }else
        if(opt1==''){
            $('#msgQues').html('please enter option one');
        }else
        if(opt2==''){
            $('#msgQues').html('please enter option second');
        }else
        if(opt3==''){
            $('#msgQues').html('please enter option third');
        }else
        if(opt4==''){
            $('#msgQues').html('please enter option fourth');
        }else
        if(corr==''){
            $('#msgQues').html('please select correct option');
        }else{
            $('#msgQues').html('');
        $.ajax({
            url:"/addNewQuestion?ques="+ques+"&opt1="+opt1+"&opt2="+opt2+"&opt3="+opt3+"&opt4="+opt4+"&corr="+corr,
            type:"POST",
            data: "",
            success:function(response){
                console.log('QuestionId:'+response);
                validQues.push(response);
                var flag = '1';
                fetchQuestions(validQues,flag);
                
                console.log('data added successfully');
                
            },
            error:function(xhr){
                $('#msg').html('Error to submit question data');
            }
        });
        }
    }

    var quesIDList = [];
    function addQues(){
        console.log('inside addQues');
        var corr = $('#correct').val();
        var ques = $('#questionInput').val();
        var opt1 = $('#option1').val();
        var opt2 = $('#option2').val();
        var opt3 = $('#option3').val();
        var opt4 = $('#option4').val();
        if(ques==''){
            $('#msgQues').html('please enter question');
        }else
        if(opt1==''){
            $('#msgQues').html('please enter option one');
        }else
        if(opt2==''){
            $('#msgQues').html('please enter option second');
        }else
        if(opt3==''){
            $('#msgQues').html('please enter option third');
        }else
        if(opt4==''){
            $('#msgQues').html('please enter option fourth');
        }else
        if(corr==''){
            $('#msgQues').html('please select correct option');
        }else{
            $('#msgQues').html('');
        $.ajax({
            url:"/addNewQuestion?ques="+ques+"&opt1="+opt1+"&opt2="+opt2+"&opt3="+opt3+"&opt4="+opt4+"&corr="+corr,
            type:"POST",
            data: "",
            success:function(response){
                console.log('QuestionId:'+response);
                quesIDList.push(response);
                var flag = '1';
                fetchQuestions(quesIDList,flag);
                
                console.log('data added successfully');
                
            },
            error:function(xhr){
                $('#msg').html('Error to submit question data');
            }
        });
        }
    }
    var quesListDiv = '';
    function fetchQuestions(QuesList,indic){
        console.log('inside fetchQuestions');
        console.log(QuesList);
            var QuesList = JSON.stringify(QuesList);
            $.ajax({
            url:"/fetchQuesList?indic="+indic,
            type:"POST",
            contentType:"application/json",
            data: QuesList,
            success:function(response){
                $('.with-gap').prop("checked",false);
                $('#option1').val('');
                $('#option2').val('');
                $('#option3').val('');
                $('#option4').val('');
                $('#questionInput').val('');
                var question = response.toString().split(':')[0];
                var op1 = response.toString().split(':')[1];
                var op2 = response.toString().split(':')[2];
                var op3 = response.toString().split(':')[3];
                var op4 = response.toString().split(':')[4];
                var corrOpt = response.toString().split(':')[5];
                console.log(question+' : '+op1+' : '+op2+' : '+op3+' : '+op4+' : '+corrOpt);
                quesListDiv = quesListDiv + '<tr><td style="padding-top:10px;"><h4 style="margin-left:5px;">'+question+'</h4><ul style="margin-left:7px;"><li>'+op1+'<span id="'+op1+'"></span></li><li>'+op2+'<span id="'+op2+'"></span></li><li>'+op3+'<span id="'+op3+'"></span></li><li>'+op4+'<span id="'+op4+'"></span></li></ul></td></tr>';
                var ids = '#'+corrOpt;
                console.log('Id:'+ids);
                
                $('#questionList').html(quesListDiv);
                $(ids).html('<i class="fa fa-check" style="color:green;font-size:15px;margin-left:10px;" aria-hidden="true"></i>');
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    }

    function tickCorrect(quesList){
        console.log('question List:'+quesList);
        quesList = JSON.stringify(quesList);
        var topic_id = $('#topicId').val();
        $.ajax({
            url:"/fetchTickCorrect?topic_id="+topic_id,
            type:"POST",
            contentType:"application/json",
            data: quesList,
            success:function(response){
                var responseArr = response.toString().split(',');
                for(var i=0;i<responseArr.length;i++){
                    var option = responseArr[i].toString().split(':')[0];
                    var qId = responseArr[i].toString().split(':')[1];
                    var ids = '#'+option+qId;
                    console.log('Id:'+ids);
                    $(ids).html('<i class="fa fa-check" style="color:green;font-size:15px;margin-left:10px;" aria-hidden="true"></i>');
                }
            },
            error:function(xhr){

            }
        });
    }

    $(document).ready(function () {
        $('#level_val').val('{{levelId}}');
        $('.parallax').parallax();
        $('.modal').modal();
        $('.datepicker').datepicker();
        $('.timepicker').timepicker();
        $('.chips').chips();
        dat = [];
        k=0;
        {% for des in desc %}
            var a = [];
            dict = {
                id:'{{des}}',
                firstName:'{{des}}'
            }
            dat.push(dict);
            k=k+1;
        {% endfor %}
        $('select').formSelect();
        $('#topicSearch').magicsearch({
            
            dataSource: dat,
            fields: ['firstName'],
            id: 'id',
            format: '%firstName%',
            multiple: true,
            multiField: 'firstName',
            dropdownMaxItem: 8,
            multiStyle: {
                space: 5,
                width: 150
            },
            focusShow: true
        });
    });
</script>
<script>
    var validQues = [];
    function myFunction() {
        var input, filter, ul, li, a, i, txtValue;
        input = document.getElementById("myInput");
        filter = input.value.toUpperCase();
        ul = document.getElementById("myUL");
        li = ul.getElementsByTagName("li");
        for (i = 0; i < li.length; i++) {
            a = li[i].getElementsByTagName("a")[0];
            txtValue = a.textContent || a.innerText;
            if (txtValue.toUpperCase().indexOf(filter) > -1) {
                li[i].style.display = "";
            } else {
                li[i].style.display = "none";
            }
        }
    }

    $('#saveAndPublish').click(function($e){
        $e.preventDefault();
        var form = $('#courseForm');
        var idealfor = $('#topicSearch').attr('data-id');
        console.log('Data:'+idealfor);
        var course_status = "Published";
        var course_id = $('#courseId').val();

        var Cname = $('#course').val();
        var desc = $('#description').val();
        var imgUrl = $('#imageUrl').val();
        var vUrl = $('#videoUrl').val();
        var tSear = $('#topicSearch').val();
        var level = $('#level_val').val();
        if(Cname==''){
            $('#msg').html('please enter course name');
        }else
        if(desc==''){
            $('#msg').html('please enter course description');
        }else
        if(imgUrl==''){
            $('#msg').html('please select Image');
        }else
        if(vUrl==''){
            $('#msg').html('please select video');
        }else
        if(level==''){
            $('#msg').html('please select course difficulty level');
        }else{
        $.ajax({
            url:"/saveAndPublishedCourse?course_status="+course_status+"&idealfor="+idealfor+"&course_id="+course_id,
            type:"POST",
            data: form.serialize(),
            success:function(response){
                if(response){
                    console.log('data added successfully');
                    M.toast({html: 'Data added and published'});
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
        }
    });

    $('#save').click(function($e){
        $e.preventDefault();
        var form = $('#courseForm');
        var idealfor = $('#topicSearch').attr('data-id');
        console.log('Data:'+idealfor);
        var course_status = "Draft";
        var course_id = $('#courseId').val();

        var Cname = $('#course').val();
        var desc = $('#description').val();
        var imgUrl = $('#imageUrl').val();
        var vUrl = $('#videoUrl').val();
        var tSear = $('#topicSearch').val();
        var level = $('#level_val').val();
        if(Cname==''){
            $('#msg').html('please enter course name');
        }else
        if(desc==''){
            $('#msg').html('please enter course description');
        }else
        if(imgUrl==''){
            $('#msg').html('please select Image');
        }else
        if(vUrl==''){
            $('#msg').html('please select video');
        }else
        if(level==''){
            $('#msg').html('please select course difficulty level');
        }else{

        $.ajax({
            url:"/saveCourse?course_status="+course_status+"&idealfor="+idealfor+"&course_id="+course_id,
            type:"POST",
            data: form.serialize(),
            success:function(response){
                if(response){
                    console.log('data added successfully');
                    M.toast({html: 'Data added successfully'});
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
        }
    });

    // Upload File Start
    function uploadFile(file, s3Data, url,videoZone){
        console.log('inside uploadFile');
      const xhr = new XMLHttpRequest();
      xhr.open('POST', s3Data.url);
      xhr.setRequestHeader('x-amz-acl', 'public-read');
      const postData = new FormData();
      for(key in s3Data.fields){
        postData.append(key, s3Data.fields[key]);      
      }
      postData.append('file', file);
      xhr.onreadystatechange = () => {
        if(xhr.readyState === 4){
          if(xhr.status === 200 || xhr.status === 204){
            console.log('videoZone:'+videoZone);
            if(videoZone=='1'){
                console.log('if file for courseUrl');
            document.getElementById('preview').src = url;
            document.getElementById('videoUrl').value=url;
            }else
            if(videoZone=='2'){
                console.log('if file is for notesUrl');
                $('.videoNotesUrl').val(url);
                $('#fileLoader').hide();
                // document.getElementById('previewNotes').src = url;
            }
            if(videoZone=='10'){
                $('#videoRecordUrl').val(url);
            }
            else{
                console.log('if file for imageUrl');
                document.getElementById('previewImg').src = url;
                document.getElementById('imageUrl').value=url;
            }
            console.log(url);
          }
          else{
            //window.alert("this is where the problem is");
            $('#errorMSGSpan').html('Could not upload file.');
            //alert('Could not upload file.');
          }
        }
      };
      xhr.send(postData);
    }
    function getSignedRequest(file,videoZone){
      const xhr = new XMLHttpRequest();
      var type = file.type;
      var VideoName = file.name;
      console.log('File Name:'+type);
      console.log('file type:'+VideoName);
      $('#video_name').html(VideoName);
      xhr.open('GET', `/sign-s3?file-name=${VideoName}&file-type=${type}&folder=courseVideo`);
      xhr.onreadystatechange = () => {
        if(xhr.readyState === 4){
          if(xhr.status === 200){
            const response = JSON.parse(xhr.responseText);
            uploadFile(file, response.data, response.url,videoZone);
          } 
          else{
            $('#errorMSGSpan').html('Could not get signed URL.');           
          }
        }
      };
      xhr.send();
    }
    function initUpload(videoZone){
        console.log('inside initUpload');
        console.log(videoZone);
        var files = '';
    if(videoZone=='1'){
       files = document.getElementById('video_url').files;
    }else
    if(videoZone=='2'){
        $('#fileLoader').show();
        console.log('video zone is 2');
         files = document.getElementById('video_notes_url').files;
         console.log('fileName:'+files);
         console.log(files[0].filename);
    }else
    if(videoZone=='10'){
        files = document.getElementById('video_record_url').files;
    }
    else{
        files = document.getElementById('courseImg').files;
    }
      const file = files[0];
      if(!file){
        return alert('No file selected.');
      }
      console.log('FileName:'+file);
      getSignedRequest(file,videoZone);
    }
    // End

    function topicList(){
        $('#topicListDiv').html('');
        var courseId = $('#courseId').val();
        $.ajax({
            url:"/fetchQues?courseId="+courseId,
            type:"POST",
            data: "",
            success:function(response){
                var topicList = '';
                if(response){
                    var responseArr = response.toString().split(',');
                    
                    for(var i=0;i<responseArr.length;i++){
                        var topicName = responseArr[i].toString().split(':')[0];
                        var quesNo = responseArr[i].toString().split(':')[1];
                        var topicId = responseArr[i].toString().split(':')[2]; 
                        console.log('Topic name:'+topicName);
                        console.log('QuesNo:'+quesNo);
                        console.log('TopicId:'+topicId);
                        topicList = '<tr><td><a class="modal-trigger" onclick="editTopic('+topicId+');editQues();" href="#topicAddModal">'+topicName+'</a></td><td>'+quesNo+'</td><td><a class="modal-trigger" onclick="topicId('+topicId+');" href="#topicNotesModal">Add Notes</a></td><td><a class="modal-trigger" onclick="topicId('+topicId+');" href="#recordClassModal">Add Class Recording</a></td><td><a title="Delete Need" name="" href="javascript:void(0);" onclick="deleteTopic('+topicId+');" class=" btn-floating btn-small orange deleteBTNClass"><i class="material-icons small" style="cursor:pointer;">delete</i></a></td></tr>' + topicList;
                    }
                    $('#topicListDiv').html(topicList);
                    
                }else{
                    topicList = '<tr><td colspan="5" style="text-align:center;">No Topic available</td></tr>';
                    $('#topicListDiv').html(topicList);
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    }

    $(document).ready(function(){
        $('.tabs').tabs();
        $('#section1').show();
        $('#section2').hide();
        // var courseId = $('#courseId').val();
        // $.ajax({
        //     url:"/fetchTopicsQues?courseId="+courseId,
        //     type:"POST",
        //     data: "",
        //     success:function(response){
        //         if(response){
        //             var responseArr = response.toString().split(',');
        //             for(var i=0;i<responseArr.length;i++){
        //                 var topicName = responseArr[i].toString().split(':')[0];
        //                 var quesNo = responseArr[i].toString().split(':')[1];
        //                 console.log('Topic name:'+topicName);
        //                 console.log('QuesNo:'+quesNo);
        //             }
                    
        //         }
        //     },
        //     error:function(xhr){
        //         $('#msg').html('Error to submit course data');
        //     }
        // });

    });
    $('#topic').click(function(){
        $('#section1').show();
        $('#section2').hide();
    });
    $('#notes').click(function(){
        $('#section2').show();
        $('#section1').hide();
    });

    $('#searchIcon').click(function(){
        var topic = $('#myInput').val();
        var courseId = "{{course_id}}";
        console.log(courseId);
        $.ajax({
            url:"/searchTopic?topic="+topic+"&courseId="+courseId,
            type:"POST",
            data: "",
            success:function(response){
                var topicList = '';
                if(response){
                    var responseArr = response.toString().split(',');
                    console.log('if response is not null');
                    
                    for(var i=0;i<responseArr.length;i++){
                        var topic_id = responseArr[i].toString().split(':')[0];
                        var topic_name = responseArr[i].toString().split(':')[1];
                        var course_id = responseArr[i].toString().split(':')[2];
                        topicList = topicList + '<li><a class="modal-trigger" id="'+topic_id+'" onclick="editTopic('+topic_id+');courseID('+course_id+');topicName('+topic_id+');" href="#topicAddModal">'+topic_name+'</a></li><input type="hidden" id="'+topic_id+'" value="'+topic_name+'">';
                        
                    }
                    $('#myUL').html(topicList);
                }else{
                    topicList = 'No Topic Suggestions Available';
                }
                $('#myUL').html(topicList);
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    }); 
    var courId = '';
    function courseID(cId){
        console.log('selected course ID:'+cId);
        courId = cId;
    }

    function topicName(topic_id){

        $('.newQuestion').show();
        $('.forEdit').hide();
        console.log('TopicId:'+topic_id);
        quesIDList = [];
        $.ajax({
            url:"/topicName?topic_id="+topic_id,
            type:"POST",
            data: "",
            success:function(response){
                console.log('Topic Name:'+response);
                $('#topicName').val(response);
                $('#topicId').val(topic_id);
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    }

    $('#updateTopic').click(function(){
        $('#quesForm').html('');
        questionDiv = '';
        
        $('.forEdit').show();
        var topicName = $('#topicName').val();
        var courseId = $('#courseId').val();
        var topicId = $('#topicId').val();
        console.log('Topic Name:'+topicName);
        console.log('courseId:'+courseId);
        console.log('list of question ids');
        console.log(validQues);
        validQues = JSON.stringify(validQues);
        $.ajax({
            url:"/updateCourseTopic?topicId="+topicId+"&courseId="+courseId+"&topicName="+topicName+"&courId="+courId,
            type:"POST",
            contentType:"application/json",
            data: validQues,
            success:function(response){
                if(response=='1'){
                    M.toast({html: 'Topic updated successfully'});
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    });

    $('#saveTopic').click(function(){
        $('#quesForm').html('');
        questionDiv = '';
        $('.newQuestion').show();
        var topicName = $('#topicName').val();
        var courseId = $('#courseId').val();
        var topicId = $('#topicId').val();
        console.log('Topic Name:'+topicName);
        console.log('courseId:'+courseId);
        console.log('list of question ids');
        console.log(quesIDList);
        quesIDList = JSON.stringify(quesIDList);
        $.ajax({
            url:"/addCourseTopic?topicName="+topicName+"&courseId="+courseId+"&topicId="+topicId+"&courId="+courId,
            type:"POST",
            contentType:"application/json",
            data: quesIDList,
            success:function(response){
                if(response){
                    M.toast({html: 'Topic added successfully'});
                    $('#topicId').val(response);
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    });

    function deleteQues(quesId){
        console.log('inside deleteQues');
        for(var i=0;i<validQues.length;i++){
            if(validQues[i]==quesId){
                validQues.splice(i,1);
            }
        }
        // if(validQues.length>0){
            validQues = JSON.stringify(validQues);
            $.ajax({
            url:"/fetchRemQues",
            type:"POST",
            contentType:"application/json",
            data: validQues,
            success:function(response){
                if(response){
                    var responseArr = response.toString().split(',');
                    var quesListDiv = '';
                    for(var i=0;i<responseArr.length;i++){
                        var ques = responseArr[i].toString().split(':')[0];
                        var opt1 = responseArr[i].toString().split(':')[1];
                        var opt2 = responseArr[i].toString().split(':')[2];
                        var opt3 = responseArr[i].toString().split(':')[3];
                        var opt4 = responseArr[i].toString().split(':')[4];
                        var quesId = responseArr[i].toString().split(':')[5];
                        console.log('Question:'+ques);
                        console.log('op1:'+opt1);
                        console.log('op2:'+opt2);
                        console.log('op3:'+opt3);
                        console.log('op4:'+opt4);
                        console.log('qIs:'+quesId);
                        // validQues.push(quesId);
                        // $('#topicName').val(topic_name);
                        
                        quesListDiv = quesListDiv + '<tr><td style="padding-top:10px;"><h4 style="margin-left:5px;">'+ques+'</h4><ul style="margin-left:7px;"><li>'+opt1+'<span id="'+opt1+'"></span></li><li>'+opt2+'<span id="'+opt2+'"></span></li><li>'+opt3+'<span id="'+opt3+'"></span></li><li>'+opt4+'<span id="'+opt4+'"></span></li></ul></td><td><a title="Delete Need" name="" onclick="deleteQues('+quesId+')" href="#" class=" btn-floating btn-small orange deleteBTNClass"><i class="material-icons small">delete</i></a></td></tr>';
                        // var ids = '#'+corrOpt;
                        // console.log(ids);
                        
                        // $(ids).html('<i class="fa fa-check" style="color:green;font-size:15px;margin-left:10px;" aria-hidden="true"></i>');
                    }
                    $('#questionList').html(quesListDiv);
                    
                }else{
                    $('#questionList').html('<tr><td style="padding-top:10px;"><h4>No Questions Available</h4></td></tr>');
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    // }
    }

    
    function editTopic(topic_id){
        validQues = [];
        var courseId = "{{course_id}}";
        $.ajax({
            url:"/fetchTopicQues?topic_id="+topic_id+"&courseId="+courseId,
            type:"POST",
            data: "",
            success:function(response){
                if(response){
                    console.log('fetch Topic Ques');
                    var responseArr = response.toString().split(',');
                    var quesListDiv = '';
                    for(var i=0;i<responseArr.length;i++){
                        var ques = responseArr[i].toString().split(':')[0];
                        var topic_name = responseArr[i].toString().split(':')[1];
                        var opt1 = responseArr[i].toString().split(':')[2];
                        var opt2 = responseArr[i].toString().split(':')[3];
                        var opt3 = responseArr[i].toString().split(':')[4];
                        var opt4 = responseArr[i].toString().split(':')[5];
                        var quesId = responseArr[i].toString().split(':')[6];
                        var topicId = responseArr[i].toString().split(':')[7];
                        
                        console.log('Question:'+ques);
                        console.log('op1:'+opt1);
                        console.log('op2:'+opt2);
                        console.log('op3:'+opt3);
                        console.log('op4:'+opt4);
                        validQues.push(quesId);
                        console.log('topic name:'+topic_name);
                        console.log('Topic Id:'+topicId);
                        $('#topicName').val(topic_name);
                        $('#topicId').val(topicId);
                        quesListDiv = quesListDiv + '<tr><td style="padding-top:10px;"><h4 style="margin-left:5px;">'+ques+'</h4><ul style="margin-left:7px;"><li>'+opt1+'<span id="'+opt1+quesId+'"></span></li><li>'+opt2+'<span id="'+opt2+quesId+'"></span></li><li>'+opt3+'<span id="'+opt3+quesId+'"></span></li><li>'+opt4+'<span id="'+opt4+quesId+'"></span></li></ul></td><td><a title="Delete Need" onclick="deleteQues('+quesId+');" name="" href="#" class=" btn-floating btn-small orange deleteBTNClass"><i class="material-icons small" style="cursor:pointer">delete</i></a></td></tr>';
                        // var ids = '#'+corrOpt;
                        // console.log(ids);
                        
                        // $(ids).html('<i class="fa fa-check" style="color:green;font-size:15px;margin-left:10px;" aria-hidden="true"></i>');
                    }
                    $('#questionList').html(quesListDiv);
                    tickCorrect(validQues);
                    
                }else{
                    $('#questionList').html('<tr><td style="padding-top:10px;"><h4>No Questions Available</h4></td></tr>');
                }
            },
            error:function(xhr){
                $('#msg').html('Error to submit course data');
            }
        });
    }

    function courseAdd(){
        console.log('inside course add');
        var course = $('#course').val();
        $.ajax({
            url:"/courseEntry?course="+course,
            type:"POST",
            data: "",
            success:function(response){
                console.log('success:'+response);
                $('#courseId').val(response);
            },
            error:function(xhr){

            }
        });
    }

    // $('#sa').click(function(){
    //     var notesName = $('#notesName').val();
    //     var notesUrl = $('#videoNotesUrl').val();
    //     var url = $('#notesURL').val();
    //     var topicId  = $('#topicId').val();
    //     console.log('Notes Name:'+notesName);
    //     var NotesFileUrl = '';
    //     if(notesUrl){
    //     console.log('Notes Url:'+notesUrl);
    //     NotesFileUrl = notesUrl;
    //     }else{
    //         NotesFileUrl = url;
    //     }
    //     console.log('final Url:'+NotesFileUrl);
    //     $.ajax({
    //         url:"/addNotes?topicId="+topicId+"&notesName="+notesName+"&NotesFileUrl="+NotesFileUrl,
    //         type:"POST",
    //         data: "",
    //         success:function(response){
    //             console.log('success:'+response);
    //             if(response=="1"){
    //                 M.toast({html: 'Notes added successfully'});
    //             }
    //         },
    //         error:function(xhr){

    //         }
    //     });
    // });

    function deleteTopic(topic_id){
        console.log('TopicID:'+topic_id);
        var course_id = "{{course_id}}";
        $.ajax({
            url:"/deleteTopic?topicId="+topic_id+"&course_id="+course_id,
            type:"POST",
            data: "",
            success:function(response){
                console.log('success:'+response);
                if(response=="1"){
                    M.toast({html: 'Topic deleted successfully'});
                    topicList();
                }
            },
            error:function(xhr){

            }
        });
    }

    function addNew(){
        $('#saveTopic').show();
        $('#updateTopic').hide();
        $('#notesName').val('');
        $('#notesURL').val('');

        $('.newQuestion').show();
        $('.forEdit').hide();
    }
</script>
{%endblock%}