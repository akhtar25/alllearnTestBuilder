{%extends "layout.html"%} {%block content%}
<div class="container">
  <div class="skin-blue sidebar-mini">
    <aside class="main-sidebar">
      
      <section class="sidebar">
        <ul class="sidebar-menu" data-widget="tree">
          <li class="treeview menu-open" style="padding: 10px;">            
                <i class="glyphicon glyphicon-education"></i>
              <span style='font-size:15px'><a href="{{url_for('leaderBoard')}}" >All</a></span>
            </a>
          </li>
          {% for singleClass in distinctClasses %}
          <li class="treeview" style="padding: 10px;">
            
              <i class="glyphicon glyphicon-education"></i>
              <span style='font-size: 15px;'><a href="{{url_for('leaderBoard', class_val=singleClass[0])}}"  name="{{singleClass[0]}}">Class {{singleClass[0]}}</a></span>
              <span class="pull-right-container">
                <span class="label label-primary pull-right">{{singleClass[1]}}</span>
              </span>            
          </li>
          {% endfor %}
          <ul>
      </section>
    </aside>
  </div>

  <div class="content-wrapper" style="background-color: white;">
  <div class="box">
    <div class="box-header">
      {% if qclass_val!=None %}
        <h3 class="box-title">Leaderboard for</h3> <span style="padding-left: 10px;font-size: 16px;padding-top: 20px;font-size: 19px;"> Class: {{qclass_val}}<span id="classNo">
      {% else %}
        <h3 class="box-title">Leaderboard for</h3> <span style="padding-left: 10px;font-size: 16px;padding-top: 20px;font-size: 19px;"> Class: All<span id="classNo">
      {% endif %}
        </span></span>
    </div>
    <div class="input-field col s6" style="width: 50%;">
        <select id="subjects" multiple>
          <option value="" disabled selected> Select Subjects</option>
          {% for sub in subject %}
          <option value="{{sub.msg_id}}" id="{{sub.msg_id}}" style="display: none;">{{sub.description}}</option>
          {% endfor %}
        </select>
        <label>Select Subjects</label>
      </div>
    <form action="" method="POST" enctype="multipart/form-data" style="margin-left: 30px;">
      {{ form.hidden_tag() }}
      <div class="form-group ">
        <div class="row" id="classDetailsDiv">
          <div class="col-sm-2" style="width: 200px;display: none;">
            <div>
                {{ form.subject_name.label(class='labelsize') }}
                <div id='loaderSubject' style='display: none; float: right;'>
                    <img src='../static/images/spinner.gif' width='25px' height='25px'>
                </div>
                <br>
                {% if form.subject_name.errors %}
                {{ form.subject_name(class="form-control form-control-lg is-invalid") }}
                <div class="invalid-feedback">
                    {% for error in form.subject_name.errors %}
                    <span>{{ error }}</span>
                    {% endfor %}
                </div>
                {% else %}
                {{ form.subject_name(class='form-control') }}
                {% endif %}
            </div>
        </div>
    <div class="row">
        <div id="admin" class="col s12">
          <div class="card material-table" id="firstTable">
            <div class="table-header">
              <span class="table-title" style="display: flex;">
                  
              </span>
              <div class="actions">
                <a href="#" class="search-toggle waves-effect btn-flat nopadding"><i class="material-icons">search</i></a>
              </div>
            </div>
            <table id="datatable">
              <thead>
                <tr>{% for columnName in columnNames %}
                    {% if loop.index!=1 %}
                    <th style="font-size: 15px;width:180px;" id="st">{{columnName}}</th>
                    {% endif %}
                    {% endfor %}
                    {% for subCol in subColumn%}
                    <th style="font-size: 15px;width:180px;display: none;" id="{{subCol}}">{{subCol}}</th>
                    {% endfor %}
                    
                </tr>
              </thead>
              <tbody>
                  {% for data in leaderBoardData %}
                      <tr>
                      {% for i in colAll %}
                        {% set d = data[loop.index-1] %}
                        <td style="font-size: 15px;">{{d}}</td>
                      {% endfor %}
                      
                    </tr>
                  {% endfor %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
      </div>
      </form>
  </div>
    <div class="tableDynamic">
    <div id="dynamicDataTable">
        
    </div>
    <div id="loader" style="display: none;padding-left: 300px;padding-top: 150px;padding-bottom: 250px;">
        <img src="../static/images/loader.gif">
    </div>
  </div>
  </div>

</div>
<link rel="stylesheet" href="../static/css/skins/_all-skins.min.css">
<script>
$(document).ready(function(){
  document.getElementById("marks").width="120px";
$('#datatable').dataTable( {
    "order": [ 3, 'desc' ]
} );
$("TH").css("width",120);
$("#st").css("width",180);
$("#evs").css("width",160);
$("#tests").css("width",100);
// $("#st").removeClass("sorting_asc");
});



  $(document).ready(function(){
    $('select').formSelect();
  });

  subject = document.getElementById('subjects');

  subject.click(function(){
    console.log('Inside Ready');
$('#subjects').onchange=function(){
  console.log('Inside Each function');
 thevalue += $(this).val() + ",";
 console.log('Values:'+thevalue);
//your code here
};

});
$('#subjects').click(function(){
function getSelectValues(select) {
  var result = [];
  var options = select && select.options;
  var opt;

  for (var i=0, iLen=options.length; i<iLen; i++) {
    opt = options[i];

    if (opt.selected) {
      result.push(opt.value || opt.text);
    }
  }
  return result;
}
var el = document.getElementsByTagName('select')[0];
  alert(getSelectValues(el));
});


$("#subjects").change(function(){
    var selectedValues = [];    
    $("#subjects :selected").each(function(){
        selectedValues.push($(this).val()); 
    });
    // alert(selectedValues);
    // alert(selectedValues.length)
    for(i=0;i<selectedValues.length;i++){
      console.log('Inside for loop for selected Values');
      {% for subcol in subColumn %}
        console.log('Inside for loop for subject Column');
      {% set list1 = subcol.split('_') %}
        var subColid = "{{list1[0]}}";
        console.log('Sub column id:'+subColid);
        console.log('Selected sub id:'+selectedValues[i]);
      if(selectedValues[i]== subColid){
        console.log('Inside check if both ids are equal');
        $('#{{subcol}}').show();
        
      } 
      {% endfor %}
    }
    return false;
});

$(document).ready(function(){
  console.log('Inside document Ready');
  {% for subCol in subColumn%}
  {% set list1 = subCol.split('_') %}
    {% for sub in subject %}
    var subid = "{{sub.msg_id}}";
      if(list1==subid){
        console.log('Inside if');
        $('#{{sub.msg_id}}').show();
      }
    {% endfor %}
  {% endfor %}
});
</script>

{% endblock %}